<?xml version="1.0" encoding="utf-8"?>

<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:pages="clr-namespace:Stickr.ViewModels.Pages"
    xmlns:converters="clr-namespace:Stickr.Converters"
    xmlns:elements="clr-namespace:Stickr.ViewModels.Elements"
    x:Class="Stickr.Views.Pages.CollectionDetailsView"
    x:DataType="pages:CollectionDetailsViewModel"
    Title="{Binding Title}">

    <ContentPage.Resources>
        <converters:BoolToColorConverter x:Key="BoolToColorConverter" />
    </ContentPage.Resources>
    <ScrollView>
        <VerticalStackLayout Padding="16" Spacing="12">
            
            <CarouselView ItemsSource="{Binding Pages}"
                          HeightRequest="400">

                <CarouselView.ItemTemplate>
                    <DataTemplate x:DataType="elements:CollectionPageViewModel">
                        <VerticalStackLayout Padding="16" Spacing="12">

                            <Label Text="{Binding PageNumber, StringFormat='Page {0}'}"
                                   FontAttributes="Bold"
                                   HorizontalOptions="Center" />

                            <CollectionView ItemsSource="{Binding Stickers}"
                                            ItemsLayout="VerticalGrid, 4"
                                            SelectionMode="None">

                                <CollectionView.ItemTemplate>
                                    <DataTemplate x:DataType="elements:StickerViewModel">
                                        <Frame Padding="0"
                                               WidthRequest="70"
                                               HeightRequest="70"
                                               CornerRadius="8"
                                               BorderColor="{Binding IsCollected,
                                       Converter={StaticResource BoolToColorConverter}}">
                                            <Frame.GestureRecognizers>
                                                <TapGestureRecognizer
                                                    Command="{Binding NavigateToDetailsCommand}" />
                                            </Frame.GestureRecognizers>
                                            
                                            <Label Text="{Binding StickerNumber}"
                                                   HorizontalOptions="Center"
                                                   VerticalOptions="Center"
                                                   FontAttributes="Bold" />

                                        </Frame>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>

                            </CollectionView>

                        </VerticalStackLayout>
                    </DataTemplate>
                </CarouselView.ItemTemplate>

            </CarouselView>
            
            <Button Text="Lists"
                    Command="{Binding OpenStatsCommand}"/>
            
            <Button
                Text="Scan stickers"
                Command="{Binding ScanStickersCommand}" />

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>